{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 46, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Humza/OneDrive/Documents/Programming/Personal/orbis/apps/web/app/api/nasa/epic/route.ts"],"sourcesContent":["import { NextResponse } from \"next/server\";\n\n/**\n * Fetches the latest NASA EPIC (Earth Polychromatic Imaging Camera) image.\n * Uses the NASA API key from env. Key is never exposed to the client.\n */\nexport async function GET() {\n  const apiKey = process.env.NASA_API_KEY;\n  if (!apiKey) {\n    return NextResponse.json(\n      { error: \"NASA_API_KEY not configured\" },\n      { status: 503 }\n    );\n  }\n\n  try {\n    const res = await fetch(\n      `https://api.nasa.gov/EPIC/api/natural?api_key=${apiKey}`,\n      { next: { revalidate: 3600 } }\n    );\n\n    if (!res.ok) {\n      return NextResponse.json(\n        { error: \"NASA EPIC API request failed\" },\n        { status: 502 }\n      );\n    }\n\n    const data = await res.json();\n    if (!Array.isArray(data) || data.length === 0) {\n      return NextResponse.json(\n        { error: \"No EPIC imagery available\" },\n        { status: 404 }\n      );\n    }\n\n    const latest = data[0];\n    const { image, date } = latest;\n    const [year, month, day] = date.split(\"-\");\n\n    const imageUrl = `https://epic.gsfc.nasa.gov/archive/natural/${year}/${month}/${day}/png/${image}.png`;\n\n    return NextResponse.json({\n      imageUrl,\n      date,\n      caption: latest.caption ?? `Earth from DSCOVR - ${date}`,\n    });\n  } catch (e) {\n    console.error(\"NASA EPIC fetch error:\", e);\n    return NextResponse.json(\n      { error: \"Failed to fetch EPIC imagery\" },\n      { status: 500 }\n    );\n  }\n}\n"],"names":[],"mappings":";;;;AAAA;;AAMO,eAAe;IACpB,MAAM,SAAS,QAAQ,GAAG,CAAC,YAAY;IACvC,IAAI,CAAC,QAAQ;QACX,OAAO,6MAAY,CAAC,IAAI,CACtB;YAAE,OAAO;QAA8B,GACvC;YAAE,QAAQ;QAAI;IAElB;IAEA,IAAI;QACF,MAAM,MAAM,MAAM,MAChB,CAAC,8CAA8C,EAAE,QAAQ,EACzD;YAAE,MAAM;gBAAE,YAAY;YAAK;QAAE;QAG/B,IAAI,CAAC,IAAI,EAAE,EAAE;YACX,OAAO,6MAAY,CAAC,IAAI,CACtB;gBAAE,OAAO;YAA+B,GACxC;gBAAE,QAAQ;YAAI;QAElB;QAEA,MAAM,OAAO,MAAM,IAAI,IAAI;QAC3B,IAAI,CAAC,MAAM,OAAO,CAAC,SAAS,KAAK,MAAM,KAAK,GAAG;YAC7C,OAAO,6MAAY,CAAC,IAAI,CACtB;gBAAE,OAAO;YAA4B,GACrC;gBAAE,QAAQ;YAAI;QAElB;QAEA,MAAM,SAAS,IAAI,CAAC,EAAE;QACtB,MAAM,EAAE,KAAK,EAAE,IAAI,EAAE,GAAG;QACxB,MAAM,CAAC,MAAM,OAAO,IAAI,GAAG,KAAK,KAAK,CAAC;QAEtC,MAAM,WAAW,CAAC,2CAA2C,EAAE,KAAK,CAAC,EAAE,MAAM,CAAC,EAAE,IAAI,KAAK,EAAE,MAAM,IAAI,CAAC;QAEtG,OAAO,6MAAY,CAAC,IAAI,CAAC;YACvB;YACA;YACA,SAAS,OAAO,OAAO,IAAI,CAAC,oBAAoB,EAAE,MAAM;QAC1D;IACF,EAAE,OAAO,GAAG;QACV,QAAQ,KAAK,CAAC,0BAA0B;QACxC,OAAO,6MAAY,CAAC,IAAI,CACtB;YAAE,OAAO;QAA+B,GACxC;YAAE,QAAQ;QAAI;IAElB;AACF"}}]
}